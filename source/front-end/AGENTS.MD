# BS Beauty Frontend - Guia para Agentes de IA

## üìã Vis√£o Geral
Sistema de agendamento de beleza com React + TypeScript + Vite, usando Redux Toolkit Query, autentica√ß√£o JWT e controle de permiss√µes baseado em roles.

### Prop√≥sito do Sistema
- Gerenciar agendamentos de servi√ßos de beleza
- Controlar profissionais, clientes e servi√ßos oferecidos
- Administrar hor√°rios de trabalho, bloqueios e turnos
- Sistema de notifica√ß√µes e comunica√ß√£o
- Analytics e relat√≥rios gerenciais
- Sistema de avalia√ß√µes de servi√ßos
- Gest√£o de pagamentos e registros financeiros

## üèóÔ∏è Arquitetura Principal

### Stack Tecnol√≥gica Completa

#### Core Technologies
- **React 18.3.1** - Library principal para UI
- **TypeScript 5.5.3** - Tipagem est√°tica
- **Vite 5.4.8** - Build tool e dev server (mais r√°pido que Webpack)
- **React Router DOM 6.28** - Roteamento SPA

#### Estado e Dados
- **Redux Toolkit 2.3.0** - Gerenciamento de estado global
- **RTK Query** - Cache e sincroniza√ß√£o de dados com API
- **React Hook Form 7.53** - Gerenciamento de formul√°rios perform√°tico
- **Zod 3.23.8** - Valida√ß√£o de schemas runtime

#### UI e Estiliza√ß√£o
- **Tailwind CSS 3.4.15** - Utility-first CSS framework
- **Headless UI 2.2.9** - Componentes acess√≠veis sem estiliza√ß√£o
- **Hero Icons 2.2.0** - Biblioteca de √≠cones SVG
- **Material UI (MUI) 7.3.4** - Componentes complexos (charts, date pickers)

#### Utilities
- **Luxon 3.5.0** - Manipula√ß√£o de datas e timezones (melhor que Moment.js)
- **Axios 1.7.7** - Cliente HTTP para requests
- **JWT Decode 4.0.0** - Decodifica√ß√£o de tokens JWT
- **React Toastify 10.0.6** - Sistema de notifica√ß√µes toast
- **React Calendar 5.1.0** - Componente de calend√°rio

### Sistema de Autentica√ß√£o
- **SessionBootstrap**: Inicializa√ß√£o autom√°tica de sess√£o com refresh tokens
- **Tokens JWT**: Access token + refresh token com rota√ß√£o autom√°tica
- **Mutex de Refresh**: Controle de concorr√™ncia em `src/store/fetch-base/custom-fetch-base.ts`
- **Persist√™ncia**: localStorage para tokens, cookies httpOnly para refresh

### Tipos de Usu√°rio e Permiss√µes
```typescript
enum UserType {
  MANAGER = "MANAGER",     // Acesso total
  PROFESSIONAL = "PROFESSIONAL", // Gerencia servi√ßos/turnos
  CUSTOMER = "CUSTOMER"    // Agenda atendimentos
}
```

### Estrutura de Rotas com Prote√ß√£o
- Rotas p√∫blicas: `/login`, `/register`, `/reset-password`
- Prote√ß√£o por role usando `PrivateRoute` com `allowedUserTypes[]`
- Sidebar autom√°tica para usu√°rios autenticados
- Redirecionamento espec√≠fico por tipo de usu√°rio

### Redux + RTK Query
- **Store centralizado**: `src/store/index.ts` com m√∫ltiplas APIs
- **Padr√£o de APIs**: Cada dom√≠nio tem sua pr√≥pria API slice (auth-api, user-api, etc.)
- **Cache e Tags**: Invalida√ß√£o autom√°tica com `providesTags`/`invalidatesTags`
- **Base Query Customizada**: Auto-refresh de tokens em `custom-fetch-base.ts`

### Estrutura de Pastas Detalhada

```
src/
‚îú‚îÄ‚îÄ api/                      # Configura√ß√µes de API
‚îÇ   ‚îî‚îÄ‚îÄ config.ts            # URLs, endpoints e vari√°veis de ambiente
‚îÇ
‚îú‚îÄ‚îÄ assets/                   # Recursos est√°ticos (imagens, SVGs, √≠cones)
‚îÇ
‚îú‚îÄ‚îÄ components/               # Componentes reutiliz√°veis
‚îÇ   ‚îú‚îÄ‚îÄ authorization/       # UserCanAccessContainer (controle de acesso)
‚îÇ   ‚îú‚îÄ‚îÄ button/              # Button component com variantes
‚îÇ   ‚îú‚îÄ‚îÄ combobox/            # Combobox/Select components
‚îÇ   ‚îú‚îÄ‚îÄ feedback/            # Loading, ErrorMessage
‚îÇ   ‚îú‚îÄ‚îÄ inputs/              # Input components especializados
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ text/           # TextInput
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ payment-methods/ # PaymentMethodsInput
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...             # Outros inputs personalizados
‚îÇ   ‚îú‚îÄ‚îÄ layouts/             # Layout wrappers
‚îÇ   ‚îú‚îÄ‚îÄ logo/                # Logo component
‚îÇ   ‚îú‚îÄ‚îÄ modal/               # Modal component
‚îÇ   ‚îú‚îÄ‚îÄ password/            # PasswordInput com toggle de visibilidade
‚îÇ   ‚îú‚îÄ‚îÄ select/              # Pagination, Select components
‚îÇ   ‚îú‚îÄ‚îÄ sidebar/             # Sidebar navigation (adapt√°vel por userType)
‚îÇ   ‚îú‚îÄ‚îÄ status/              # StatusBadge component
‚îÇ   ‚îú‚îÄ‚îÄ texts/               # Typography (Title, Subtitle, etc)
‚îÇ   ‚îî‚îÄ‚îÄ tooltip/             # Tooltip component
‚îÇ
‚îú‚îÄ‚îÄ config/                   # Configura√ß√µes gerais da aplica√ß√£o
‚îÇ
‚îú‚îÄ‚îÄ constants/                # Constantes da aplica√ß√£o
‚îÇ
‚îú‚îÄ‚îÄ enums/                    # Enumera√ß√µes (WeekDays, Status, etc)
‚îÇ
‚îú‚îÄ‚îÄ hooks/                    # Custom React Hooks
‚îÇ   ‚îú‚îÄ‚îÄ use-app-selector.ts  # Typed Redux useSelector
‚îÇ   ‚îî‚îÄ‚îÄ use-app-dispatch.ts  # Typed Redux useDispatch
‚îÇ
‚îú‚îÄ‚îÄ layouts/                  # Layouts de p√°gina
‚îÇ   ‚îî‚îÄ‚îÄ PageHeader.tsx       # Header padr√£o usado em todas as p√°ginas
‚îÇ
‚îú‚îÄ‚îÄ lib/                      # Bibliotecas e utilit√°rios de terceiros
‚îÇ
‚îú‚îÄ‚îÄ pages/                    # P√°ginas da aplica√ß√£o
‚îÇ   ‚îú‚îÄ‚îÄ analytics/           # Dashboard de analytics gerencial
‚îÇ   ‚îú‚îÄ‚îÄ appointments/        # Gerenciamento de agendamentos
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.tsx       # Lista paginada de agendamentos
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/     # CustomerAppointmentCard, etc
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ types/          # Types espec√≠ficos de appointments
‚îÇ   ‚îú‚îÄ‚îÄ blocked-times/       # Gerenciamento de hor√°rios bloqueados
‚îÇ   ‚îú‚îÄ‚îÄ callback/            # OAuth callback (Google)
‚îÇ   ‚îú‚îÄ‚îÄ complete-register/   # Completar registro p√≥s-OAuth
‚îÇ   ‚îú‚îÄ‚îÄ customers/           # Listagem e gest√£o de clientes (MANAGER)
‚îÇ   ‚îú‚îÄ‚îÄ home/                # P√°ginas home por tipo de usu√°rio
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ customer-home/  # Wizard de agendamento (cliente)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ landing-page/   # Landing page p√∫blica
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ manager-professional-home/ # Dashboard gerencial
‚îÇ   ‚îú‚îÄ‚îÄ login/               # P√°gina de login (email/senha + OAuth)
‚îÇ   ‚îú‚îÄ‚îÄ not-found/           # 404 page
‚îÇ   ‚îú‚îÄ‚îÄ notification-templates/ # Templates de notifica√ß√£o
‚îÇ   ‚îú‚îÄ‚îÄ notifications/       # Central de notifica√ß√µes
‚îÇ   ‚îú‚îÄ‚îÄ password-reset/      # Reset de senha
‚îÇ   ‚îú‚îÄ‚îÄ payments/            # Gerenciamento de pagamentos
‚îÇ   ‚îú‚îÄ‚îÄ private-route/       # Route guard component
‚îÇ   ‚îú‚îÄ‚îÄ professionals/       # Listagem e gest√£o de profissionais
‚îÇ   ‚îú‚îÄ‚îÄ profile/             # Perfil do usu√°rio logado
‚îÇ   ‚îú‚îÄ‚îÄ roles/               # Gest√£o de pap√©is e permiss√µes (RBAC)
‚îÇ   ‚îú‚îÄ‚îÄ services/            # Gerenciamento de servi√ßos oferecidos
‚îÇ   ‚îú‚îÄ‚îÄ shifts/              # Gerenciamento de turnos de trabalho
‚îÇ   ‚îî‚îÄ‚îÄ user-registration/   # Registro de novos usu√°rios
‚îÇ
‚îú‚îÄ‚îÄ providers/                # Context Providers
‚îÇ
‚îú‚îÄ‚îÄ routes/                   # Configura√ß√£o de rotas
‚îÇ   ‚îî‚îÄ‚îÄ index.tsx            # Defini√ß√£o de todas as rotas com prote√ß√£o
‚îÇ
‚îú‚îÄ‚îÄ store/                    # Redux Store com RTK Query
‚îÇ   ‚îú‚îÄ‚îÄ analytics/           # Analytics API slice
‚îÇ   ‚îú‚îÄ‚îÄ appointment/         # Appointments API slice
‚îÇ   ‚îú‚îÄ‚îÄ auth/                # Auth slice (state) e API
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth-slice.ts   # Estado local de autentica√ß√£o
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth-api.ts     # Endpoints de auth (login, logout, etc)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ server-logout.ts # Thunk de logout com limpeza de cache
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ types.ts        # Types de auth e user
‚îÇ   ‚îú‚îÄ‚îÄ blocked-times/       # Blocked times API slice
‚îÇ   ‚îú‚îÄ‚îÄ customer/            # Customer API slice
‚îÇ   ‚îú‚îÄ‚îÄ fetch-base/          # Base query customizada com auth
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ custom-fetch-base.ts # Refresh token autom√°tico
‚îÇ   ‚îú‚îÄ‚îÄ notification/        # Notifications API slice
‚îÇ   ‚îú‚îÄ‚îÄ notification-template/ # Notification templates API slice
‚îÇ   ‚îú‚îÄ‚îÄ offer/               # Service offers API slice
‚îÇ   ‚îú‚îÄ‚îÄ payment-record/      # Payments API slice
‚îÇ   ‚îú‚îÄ‚îÄ permission/          # Permissions API slice
‚îÇ   ‚îú‚îÄ‚îÄ professional/        # Professional API slice
‚îÇ   ‚îú‚îÄ‚îÄ rating/              # Ratings API slice
‚îÇ   ‚îú‚îÄ‚îÄ role/                # Roles API slice
‚îÇ   ‚îú‚îÄ‚îÄ service/             # Services API slice
‚îÇ   ‚îú‚îÄ‚îÄ shift/               # Shifts API slice
‚îÇ   ‚îú‚îÄ‚îÄ themes/              # Theme slice (dark/light mode)
‚îÇ   ‚îú‚îÄ‚îÄ user/                # User API slice
‚îÇ   ‚îú‚îÄ‚îÄ index.ts             # Store configuration (combine reducers)
‚îÇ   ‚îî‚îÄ‚îÄ types.ts             # Shared types entre slices
‚îÇ
‚îú‚îÄ‚îÄ types/                    # TypeScript types e interfaces globais
‚îÇ   ‚îî‚îÄ‚îÄ authorization.ts     # Types de autoriza√ß√£o (Permissions, etc)
‚îÇ
‚îú‚îÄ‚îÄ utils/                    # Fun√ß√µes utilit√°rias
‚îÇ   ‚îú‚îÄ‚îÄ formatter/           # Formatters (dates, currency, status, etc)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ formatter.util.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ first-letter-of-word-to-upper-case.util.ts
‚îÇ   ‚îî‚îÄ‚îÄ validation/          # Zod schemas de valida√ß√£o
‚îÇ       ‚îî‚îÄ‚îÄ zod-schemas/     # Schemas organizados por dom√≠nio
‚îÇ
‚îú‚îÄ‚îÄ App.tsx                   # Componente principal da aplica√ß√£o
‚îú‚îÄ‚îÄ SessionBootstrap.tsx      # Inicializa√ß√£o autom√°tica de sess√£o
‚îú‚îÄ‚îÄ main.tsx                  # Entry point (ReactDOM.render)
‚îî‚îÄ‚îÄ index.css                 # Estilos globais e classes customizadas
```

## üìù Conven√ß√µes de C√≥digo

### Componentes
- **Diret√≥rio**: `src/components/[categoria]/ComponentName.tsx`
- **Props Interface**: Sempre exportar interface de props
- **Styling**: TailwindCSS com classes condicionais via `clsx`
- **Variantes**: Props para diferentes estilos (ex: `variant="outline"|"solid"`)

### Estado e APIs
```typescript
// Hook padr√£o para dispatch
import useAppDispatch from './hooks/use-app-dispatch'

// Hook padr√£o para sele√ß√£o de estado
import useAppSelector from './hooks/use-app-selector'

// Padr√£o RTK Query
export const entityAPI = createApi({
  reducerPath: 'entity-api',
  baseQuery: baseQueryWithAuth, // SEMPRE usar esta base
  tagTypes: ['Entity'],
  endpoints: (builder) => ({...})
})
```

### Estiliza√ß√£o
- **Tema**: Paleta de cores definida em `tailwind.config.js`
- **Cores prim√°rias**: `primary-{0-900}` (cinzas)
- **Cores secund√°rias**: `secondary-{100-700}` (tons terrosos)
- **Background principal**: `bg-[#1E1E1E]` (escuro)

## üéØ Padr√µes Espec√≠ficos do Projeto

### Formul√°rios
- **React Hook Form** + **Zod** para valida√ß√£o
- Componentes de input personalizados em `src/components/inputs/`
- Valida√ß√£o centralizada em `src/utils/validation/`

### P√°ginas
- **Estrutura**: `src/pages/[nome]/index.tsx`
- **Subcomponentes**: `src/pages/[nome]/components/`
- **Tipos**: `src/pages/[nome]/types/`

### Configura√ß√£o de API
- **Base URL**: Din√¢mica baseada em `ENV.ENVIRONMENT`
- **Endpoints**: Centralizados em `src/api/config.ts`
- **Credentials**: Sempre `include` para cookies

### Toast Notifications
- **React-Toastify** configurado globalmente no App.tsx
- Styling customizado para tema escuro
- Usar `toast.success()`, `toast.error()`, `toast.warn()`

## üîó Pontos de Integra√ß√£o

### Google OAuth
- Fluxo completo: redirect ‚Üí callback ‚Üí exchange code ‚Üí token
- Persist√™ncia de `googleAccessToken` separada

### Refresh Token Flow
- Autom√°tico antes de cada requisi√ß√£o
- Retry em 401 com novo token
- Logout autom√°tico em falha de refresh

### Permiss√µes Din√¢micas
- Verifica√ß√£o em componentes: `userHasPermission(allowedTypes, currentType)`
- Controle de renderiza√ß√£o baseado em roles
- Rotas protegidas com valida√ß√£o server-side

### Estado de Loading/Erro
- Componentes `Loading` e `ErrorMessage` padronizados
- Estados RTK Query: `isLoading`, `isError`, `data`

## ‚ö° Comandos Essenciais
```bash
npm run dev          # Desenvolvimento local
npm run build        # Build de produ√ß√£o
npm run lint         # ESLint
npm run lint:fix     # ESLint com corre√ß√£o autom√°tica
npm run preview      # Preview do build
```

## üö´ O que N√ÉO fazer

### M√°s Pr√°ticas
- **N√ÉO** coloque l√≥gica de neg√≥cio nos componentes - use hooks personalizados
- **N√ÉO** acesse APIs diretamente nos componentes - use RTK Query hooks
- **N√ÉO** misture responsabilidades entre componentes de apresenta√ß√£o e l√≥gica
- **N√ÉO** esque√ßa de adicionar valida√ß√µes de entrada com Zod
- **N√ÉO** implemente sem considerar estados de loading/error
- **N√ÉO** quebre conven√ß√µes de nomenclatura (PascalCase para componentes)
- **N√ÉO** ignore tratamento de erros - sempre use try/catch ou error boundaries
- **N√ÉO** fa√ßa commits sem executar lint
- **N√ÉO** duplique c√≥digo - sempre aplique o princ√≠pio DRY (Don't Repeat Yourself)

### Erros Comuns
- N√£o adicionar newline no final dos arquivos
- Usar imports relativos em vez de absolutos quando poss√≠vel
- Esquecer de exportar componentes/interfaces
- N√£o mockar depend√™ncias nos testes
- N√£o seguir o padr√£o strict do Zod (`.strict()`)
- **Duplicar l√≥gica entre componentes** - sempre extrair para hooks personalizados
- Criar componentes redundantes quando um pode servir ambos os prop√≥sitos
- **Adicionar coment√°rios desnecess√°rios** - evite coment√°rios √≥bvios no c√≥digo
- **Usar mensagens de erro em portugu√™s no console** - sempre use ingl√™s

### Princ√≠pio DRY - Hooks Personalizados
```typescript
// ‚ùå MAU - L√≥gica duplicada em componentes
function CustomerList() {
  const [customers, setCustomers] = useState([])
  const [loading, setLoading] = useState(false)
  // ... l√≥gica de fetch, pagina√ß√£o, filtros
}

function ProfessionalList() {
  const [professionals, setProfessionals] = useState([])
  const [loading, setLoading] = useState(false)
  // ... mesma l√≥gica duplicada
}

// ‚úÖ BOM - Hook reutiliz√°vel
function useEntityList<T>(apiHook: any, initialFilters = {}) {
  const [filters, setFilters] = useState(initialFilters)
  const { data, isLoading, error } = apiHook(filters)
  
  return {
    data: data?.data || [],
    loading: isLoading,
    error,
    filters,
    setFilters,
  }
}
```

### Baixo Acoplamento, Alta Coes√£o
- **Componentes**: Apenas apresenta√ß√£o e intera√ß√£o do usu√°rio
- **Hooks personalizados**: L√≥gica de neg√≥cio e gerenciamento de estado
- **RTK Query**: Comunica√ß√£o com APIs
- **Utils**: Fun√ß√µes puras reutiliz√°veis

## üìã Como Implementar Nova Funcionalidade

### 1. Estrutura de Arquivos
```
src/pages/nova-feature/
‚îú‚îÄ‚îÄ index.tsx              # P√°gina principal
‚îú‚îÄ‚îÄ components/            # Componentes espec√≠ficos
‚îÇ   ‚îú‚îÄ‚îÄ FeatureForm.tsx
‚îÇ   ‚îî‚îÄ‚îÄ FeatureList.tsx
‚îî‚îÄ‚îÄ types/                 # Tipos espec√≠ficos
    ‚îî‚îÄ‚îÄ index.ts
```

### 2. Fluxo de Implementa√ß√£o

#### Passo 1: Definir Types e API
```typescript
// src/pages/nova-feature/types/index.ts
export interface Feature {
  id: string
  name: string
  // ... outros campos
}

// src/api/config.ts - Adicionar endpoints
FEATURE_ENDPOINTS: {
  ENDPOINT: '/features',
  FIND_BY_ID: (id: string) => `/features/${id}`,
}
```

#### Passo 2: Criar RTK Query Slice
```typescript
// src/store/feature/feature-api.ts
export const featureAPI = createApi({
  reducerPath: 'feature-api',
  baseQuery: baseQueryWithAuth,
  tagTypes: ['Feature'],
  endpoints: (builder) => ({
    // ... endpoints
  })
})
```

#### Passo 3: Hook Personalizado (Abstrair L√≥gica)
```typescript
// src/pages/nova-feature/hooks/useFeatureLogic.ts
export function useFeatureLogic() {
  const { data: features, isLoading } = useGetFeaturesQuery()
  const [createFeature] = useCreateFeatureMutation()
  
  const handleCreate = useCallback(async (data: CreateFeatureRequest) => {
    try {
      await createFeature(data).unwrap()
      toast.success('Feature criada com sucesso!')
    } catch (error) {
      toast.error('Erro ao criar feature')
    }
  }, [createFeature])

  return {
    features,
    isLoading,
    handleCreate,
    // ... outras funcionalidades
  }
}
```

#### Passo 4: Componente de Apresenta√ß√£o Limpo
```typescript
// src/pages/nova-feature/index.tsx
export default function NovaFeature() {
  const { features, isLoading, handleCreate } = useFeatureLogic()
  
  if (isLoading) return <Loading />
  
  return (
    <div className="p-6">
      <Title label="Nova Feature" />
      <FeatureForm onSubmit={handleCreate} />
      <FeatureList features={features} />
    </div>
  )
}
```

### 3. Integra√ß√£o com Sistema de Permiss√µes
```typescript
// Proteger rota se necess√°rio
<Route
  element={<PrivateRoute allowedUserTypes={[UserType.MANAGER]} />}
>
  <Route path="/features" element={<NovaFeature />} />
</Route>

// Ou condicional no componente
const { user } = useAppSelector(state => state.auth)
const canCreate = userHasPermission([UserType.MANAGER], user.userType)
```

### 4. Adicionar Item na Sidebar (Para Resources Isolados)
```typescript
// src/components/sidebar/consts/index.tsx - Adicionar no userType apropriado
[UserType.MANAGER]: [
  // ... outros itens existentes
  {
    name: 'Nome do Resource',
    icon: <IconeDoHeroicons className="size-6" />,
    navigateTo: '/caminho/para/resource',
  },
]
```

**‚ö†Ô∏è IMPORTANTE:** Apenas adicione itens na sidebar para resources **isolados e independentes** (ex: Roles, Permissions, Analytics). N√£o adicione para subp√°ginas ou funcionalidades que fazem parte de outro contexto.

## üìã Checklist para Nova Feature

### Antes de Come√ßar
- [ ] Definir tipos TypeScript necess√°rios
- [ ] Criar interfaces de API no arquivo de config
- [ ] Verificar permiss√µes necess√°rias por role

### Implementa√ß√£o
- [ ] Criar RTK Query API slice com tags apropriadas
- [ ] Implementar hook personalizado para l√≥gica de neg√≥cio
- [ ] Criar componentes de apresenta√ß√£o com props tipadas
- [ ] Adicionar valida√ß√£o Zod nos formul√°rios
- [ ] Implementar estados de loading/error/success
- [ ] Adicionar toast notifications apropriadas
- [ ] Configurar rotas protegidas se necess√°rio
- [ ] Adicionar item na sidebar (apenas para resources isolados)

### Finaliza√ß√£o
- [ ] Executar `npm run lint:fix`
- [ ] Testar diferentes roles de usu√°rio
- [ ] Verificar responsividade
- [ ] Testar fluxos de erro (network, valida√ß√£o, etc.)

## üêõ Debugging
- Redux DevTools habilitado
- Console logs detalhados no fluxo de auth
- Network tab para monitorar refresh tokens
- LocalStorage para verificar tokens persistidos

---

## üì¶ P√°ginas e Funcionalidades Detalhadas

### Landing Page
- P√°gina inicial p√∫blica com apresenta√ß√£o do sal√£o
- Carrossel de servi√ßos com auto-scroll (4s)
- Informa√ß√µes institucionais
- Call-to-action para login/registro

### Login
- Login com email/senha (valida√ß√£o com Zod)
- Login com Google OAuth (fluxo completo)
- Link para registro de novos usu√°rios
- Link para reset de senha
- Otimizado para mobile portrait e landscape
- Backgrounds com opacidade reduzida em landscape

### Home (Customer)
**Wizard de agendamento em m√∫ltiplos passos:**

1. **Sele√ß√£o de Fluxo**: Escolhe entre agendar por servi√ßo ou por profissional
2. **Sele√ß√£o de Servi√ßo/Profissional**: 
   - Cards com informa√ß√µes detalhadas
   - Pre√ßos e tempo estimado
   - Foto de perfil do profissional
3. **Sele√ß√£o de Hor√°rio**: 
   - Calend√°rio interativo com React Calendar
   - Slots de hor√°rio dispon√≠veis
   - Valida√ß√£o de disponibilidade em tempo real
4. **Revis√£o**: 
   - Confirma√ß√£o de todos os dados
   - Modal de permiss√£o de uso de imagem
   - Finaliza√ß√£o do agendamento

**Importante:** O wizard usa React Hook Form com context para compartilhar estado entre os steps.

### Home (Professional/Manager)
- Dashboard com m√©tricas do dia/semana/m√™s
- Carrossel de agendamentos do dia com auto-scroll
- A√ß√µes r√°pidas (novo agendamento, bloquear hor√°rio)
- Analytics resumido

### Appointments
**Lista paginada de agendamentos** (10 por p√°gina):

- **Toggle entre estados**: "Agendados" vs "Finalizados"
- **Cards adaptados ao tipo de usu√°rio**:
  - **Cliente**: v√™ foto e nome do **profissional**
  - **Profissional/Manager**: v√™ foto e nome do **cliente** que agendou
- **Badges de status**: Confirmado, Pendente, Cancelado, Reagendado, Finalizado, No-Show
- **Badges de avalia√ß√£o**: 
  - "Avalia√ß√£o Pendente" (amber) quando `rating !== null && score === null`
  - "Avaliado" (green) quando `rating !== null && score !== null`
- **A√ß√µes**: Editar (agendados) ou Visualizar (finalizados)
- **Pagina√ß√£o**: Componente reutiliz√°vel com numbered buttons e navigation arrows

**Padr√£o de prop drilling:** `index.tsx` ‚Üí `CustomerAppointments` ‚Üí `CustomerAppointmentCard`
- `userType` √© passado como prop para evitar m√∫ltiplas chamadas ao Redux

### Customers
**Lista paginada de clientes** (acesso apenas MANAGER):

- Cards com foto de perfil e informa√ß√µes b√°sicas
- Busca por nome e email (futura implementa√ß√£o)
- Filtros diversos
- Pagina√ß√£o (10 itens por p√°gina)
- Skeleton loading durante carregamento

### Professionals
**Gerenciamento completo de profissionais:**

- Lista de profissionais ativos
- Cadastro e edi√ß√£o de dados
- **Vincula√ß√£o de servi√ßos** (offers):
  - Cada profissional pode oferecer m√∫ltiplos servi√ßos
  - Pre√ßo e tempo estimado personaliz√°veis por oferta
- **M√©todos de pagamento aceitos**: Cart√£o, PIX, Dinheiro, Transfer√™ncia, etc
- **Hor√°rios de trabalho** (shifts)
- Redes sociais e informa√ß√µes de contato

### Services
**CRUD completo de servi√ßos:**

- Nome, descri√ß√£o e categoria
- Tempo estimado padr√£o
- Pre√ßo base sugerido
- Associa√ß√£o com profissionais (atrav√©s de offers)
- Status ativo/inativo

### Shifts
**Gerenciamento de turnos de trabalho:**

- Configura√ß√£o por dia da semana
- Hor√°rio de in√≠cio e fim
- Intervalo para almo√ßo/descanso
- Associa√ß√£o com profissionais espec√≠ficos
- Valida√ß√µes de conflito de hor√°rios

### Blocked Times
**Bloqueio de hor√°rios espec√≠ficos:**

- Sele√ß√£o de data e hor√°rio
- Motivo do bloqueio (feriado, manuten√ß√£o, evento, etc)
- Associa√ß√£o com profissional espec√≠fico ou todos
- Visualiza√ß√£o em formato de calend√°rio
- Dele√ß√£o de bloqueios passados

### Profile
**Perfil do usu√°rio logado** (adaptado por userType):

- **Todos**: Foto de perfil, nome, email, telefone
- **Customer**: 
  - Data de nascimento
  - Prefer√™ncias de notifica√ß√£o
  - Op√ß√£o "Sempre permitir uso de imagem"
  - C√≥digo de refer√™ncia
- **Professional**: 
  - Especializa√ß√£o
  - Redes sociais (Instagram, Facebook, etc)
  - M√©todos de pagamento aceitos
  - Biografia/descri√ß√£o
- **Manager**: Informa√ß√µes administrativas

### Notifications
**Central de notifica√ß√µes:**

- Lista de notifica√ß√µes recentes
- Marca√ß√£o de leitura individual ou em massa
- Filtros por tipo (agendamento, pagamento, sistema)
- Badge de contador n√£o lido na sidebar
- Prefer√™ncias de notifica√ß√£o (in-app, email, push)

### Analytics
**Dashboard gerencial** (acesso MANAGER):

- Gr√°ficos de agendamentos (por per√≠odo)
- Receitas e faturamento
- Servi√ßos mais populares
- Performance de profissionais
- Taxa de no-show
- M√©dia de avalia√ß√µes
- Uso de MUI Charts (LineChart, BarChart, PieChart)

### Roles e Permissions
**Sistema RBAC completo:**

- Cria√ß√£o de roles customizadas
- Atribui√ß√£o de permiss√µes granulares
- Visualiza√ß√£o de permiss√µes por m√≥dulo
- Vincula√ß√£o de roles a usu√°rios

---

## üé® Componentes Reutiliz√°veis Importantes

### Pagination
**Componente de pagina√ß√£o usado em v√°rias listas:**

```tsx
<Pagination
  totalItems={100}
  totalPages={10}
  currentPage={1}
  onPageChange={(page) => setCurrentPage(page)}
/>
```

**Features:**
- Bot√µes de primeira/√∫ltima p√°gina (ChevronDoubleLeft/Right)
- Bot√µes de anterior/pr√≥ximo (ChevronLeft/Right)
- N√∫meros de p√°gina din√¢micos com ellipsis (1, 2, 3, ..., 10)
- Design bronze (`#A4978A`) consistente com o tema
- Responsive (bot√µes menores em mobile)
- Icons do Hero Icons

### StatusBadge
**Badge para exibir status com cores sem√¢nticas:**

```tsx
<StatusBadge text="Confirmado" color="green" />
```

Cores dispon√≠veis:
- `green`: Sucesso, confirmado, avaliado
- `amber`: Pendente, avalia√ß√£o pendente
- `red`: Erro, cancelado
- `blue`: Informa√ß√£o
- `gray`: Inativo

### Button
**Bot√£o com m√∫ltiplas variantes:**

```tsx
<Button 
  label="Agendar"
  variant="primary"
  onClick={handleClick}
  disabled={isLoading}
/>
```

Variantes:
- `primary`: Bot√£o principal bronze
- `outline`: Apenas borda
- `text-only`: Sem background
- `disabled`: Estado desabilitado

### UserCanAccessContainer
**Controle de acesso baseado em permiss√µes:**

```tsx
<UserCanAccessContainer
  allowedPermissions={['customer.read', 'customer.write']}
  allowedUserTypes={[UserType.MANAGER]}
>
  <ConteudoProtegido />
</UserCanAccessContainer>
```

Se o usu√°rio n√£o tiver permiss√£o, o conte√∫do n√£o √© renderizado.

### ProfilePicture
**Foto de perfil com fallback:**

```tsx
<ProfilePicture
  size="md"
  profilePhotoUrl={user.profilePhotoUrl}
  displayName={user.name}
  variation="square-with-bg"
  filter="none" // ou "black-white" para agendamentos finalizados
/>
```

Se n√£o houver foto, exibe iniciais do nome.

---

## üéØ Padr√µes Avan√ßados e Boas Pr√°ticas

### Separa√ß√£o de Responsabilidades

#### ‚ùå Anti-pattern: L√≥gica no Componente
```tsx
function CustomerList() {
  const [customers, setCustomers] = useState([])
  const [loading, setLoading] = useState(false)
  const [page, setPage] = useState(1)
  
  useEffect(() => {
    setLoading(true)
    fetch(`/api/customers?page=${page}`)
      .then(res => res.json())
      .then(data => setCustomers(data))
      .finally(() => setLoading(false))
  }, [page])
  
  return (/* JSX */)
}
```

#### ‚úÖ Boa Pr√°tica: Hook + RTK Query
```tsx
// Hook personalizado
function useCustomerList(initialPage = 1) {
  const [page, setPage] = useState(initialPage)
  const { data, isLoading, isError } = customerAPI.useFetchCustomersQuery({
    page,
    limit: 10
  })
  
  return {
    customers: data?.data || [],
    isLoading,
    isError,
    pagination: {
      currentPage: data?.page || 1,
      totalPages: data?.totalPages || 1,
      total: data?.total || 0,
      onPageChange: setPage
    }
  }
}

// Componente limpo
function CustomerList() {
  const { customers, isLoading, pagination } = useCustomerList()
  
  if (isLoading) return <Loading />
  
  return (
    <div>
      {customers.map(customer => <CustomerCard key={customer.id} customer={customer} />)}
      <Pagination {...pagination} />
    </div>
  )
}
```

### Performance com Prop Drilling Inteligente

**Problema:** Passar `userType` via prop √© melhor que chamar `useAppSelector` em cada card quando h√° 10+ cards.

```tsx
// ‚úÖ BOM: Busca userType uma vez na p√°gina
function AppointmentsPage() {
  const user = useAppSelector(state => state.auth.user!)
  
  return (
    <CustomerAppointments
      appointments={appointments}
      userType={user.userType} // Passa como prop
    />
  )
}

// Evita 10 chamadas ao Redux (uma por card)
function CustomerAppointmentCard({ userType, appointment }) {
  const displayName = userType === UserType.CUSTOMER
    ? appointment.professional.name
    : appointment.customer.name
}
```

### Valida√ß√£o com Zod - Patterns

#### Valida√ß√£o de Formul√°rio
```typescript
import { z } from 'zod'

export const appointmentSchema = z.object({
  serviceId: z.string().uuid('ID de servi√ßo inv√°lido'),
  professionalId: z.string().uuid(),
  appointmentDate: z.string().datetime(),
  observation: z.string().max(500).optional(),
  allowImageUse: z.boolean()
}).strict() // Rejeita campos extras
```

#### Merge de Schemas
```typescript
// Reutiliza√ß√£o de schemas
const professionalAttributes = z.object({
  professionalId: z.string(),
  name: z.string(),
  professionalPhotoUrl: z.string()
})

const appointmentFormData = AppointmentSchemas.createSchemaForm
  .merge(professionalAttributes)
  .extend({
    estimatedTime: z.number(),
    price: z.number()
  })
```

### Datas e Timezones com Luxon

**SEMPRE use timezone Am√©rica/S√£o Paulo para agendamentos:**

```typescript
import { DateTime } from 'luxon'

// Parse ISO com timezone
const appointmentDate = DateTime.fromISO(isoString, { zone: 'America/Sao_Paulo' })

// Ou setZone ap√≥s parse
const date = DateTime.fromISO(isoString).setZone('America/Sao_Paulo')

// Formata√ß√£o localizada
date.setLocale('pt-BR').toLocaleString(DateTime.DATE_FULL)
// "28 de novembro de 2025"

date.toFormat('dd/MM/yyyy HH:mm')
// "28/11/2025 14:30"

// Para exibir apenas hor√°rio
date.toFormat('HH:mm')
// "14:30"

// Dia da semana abreviado
date.setLocale('pt-BR').weekdayShort?.toUpperCase()
// "DOM"
```

### RTK Query - Cache e Invalida√ß√£o

#### Padr√£o de Tags
```typescript
export const appointmentAPI = createApi({
  tagTypes: ['Appointments'],
  endpoints: (builder) => ({
    fetchAppointments: builder.query({
      providesTags: (result) =>
        result
          ? [
              ...result.data.map(({ id }) => ({ type: 'Appointments' as const, id })),
              { type: 'Appointments', id: 'LIST' }
            ]
          : [{ type: 'Appointments', id: 'LIST' }]
    }),
    createAppointment: builder.mutation({
      invalidatesTags: [{ type: 'Appointments', id: 'LIST' }]
    }),
    updateAppointment: builder.mutation({
      invalidatesTags: (result, error, { id }) => [
        { type: 'Appointments', id },
        { type: 'Appointments', id: 'LIST' }
      ]
    })
  })
})
```

Isso garante que:
- Criar/deletar: recarrega a lista
- Atualizar: recarrega item espec√≠fico + lista

#### Limpeza de Cache no Logout
```typescript
// src/store/auth/server-logout.ts
export const serverLogout = createAsyncThunk('auth/serverLogout', async (_, { dispatch }) => {
  await api.post('/auth/logout')
  
  // Limpa cache de TODAS as APIs
  dispatch(authAPI.util.resetApiState())
  dispatch(appointmentAPI.util.resetApiState())
  dispatch(customerAPI.util.resetApiState())
  // ... todas as outras APIs
  
  dispatch(logout())
})
```

---

## üîí Seguran√ßa e Autentica√ß√£o Avan√ßada

### Refresh Token com Mutex

O sistema usa **async-mutex** para evitar m√∫ltiplos refreshs simult√¢neos:

```typescript
// src/store/fetch-base/custom-fetch-base.ts
const mutex = new Mutex()

export const baseQueryWithAuth = async (args, api, extraOptions) => {
  // Espera se outro refresh estiver em andamento
  await mutex.waitForUnlock()
  
  let result = await baseQuery(args, api, extraOptions)
  
  if (result.error?.status === 401) {
    if (!mutex.isLocked()) {
      const release = await mutex.acquire()
      
      try {
        // Tenta refresh
        const refreshResult = await baseQuery('/auth/refresh', api, extraOptions)
        
        if (refreshResult.data) {
          // Sucesso: retry request original
          result = await baseQuery(args, api, extraOptions)
        } else {
          // Falhou: desloga
          api.dispatch(logout())
        }
      } finally {
        release()
      }
    }
  }
  
  return result
}
```

### Prote√ß√£o de Rotas Granular

```tsx
<Route
  element={
    <PrivateRoute
      allowedUserTypes={[UserType.MANAGER, UserType.PROFESSIONAL]}
    />
  }
>
  <Route path="/shifts" element={<Shifts />} />
</Route>
```

Dentro do componente, controle mais fino:

```tsx
const { user } = useAppSelector(state => state.auth)
const canEdit = user.permissions.includes('shift.write')

return (
  <div>
    {canEdit ? <EditButton /> : <ViewOnlyMode />}
  </div>
)
```

---

## üé® Design System e Estiliza√ß√£o

### Paleta de Cores

**Backgrounds:**
- `#1E1E1E` - Background principal (escuro)
- `#262626` - Cards e containers
- `#3A3027` - Hover states, active buttons

**Text:**
- `#D9D9D9` - Texto prim√°rio (alta legibilidade)
- `#C0C0C0` - Texto secund√°rio
- `#A4978A` - Accent bronze (bot√µes, links, √≠cones)

**Borders:**
- `#595149` - Borders sutis
- `#A4978A` - Borders em destaque (selected states)

**Status:**
- Green: `#10B981` - Sucesso
- Amber: `#F59E0B` - Aviso
- Red: `#EF4444` - Erro

### Classes Customizadas

```css
/* index.css */
.carousel-scrollbar::-webkit-scrollbar {
  height: 12px;
}

.carousel-scrollbar::-webkit-scrollbar-track {
  background: transparent;
}

.carousel-scrollbar::-webkit-scrollbar-thumb {
  background-color: #8b7a6a;
  border-radius: 4px;
}
```

Uso:
```tsx
<div className="overflow-x-auto carousel-scrollbar">
  {/* Conte√∫do com scroll horizontal */}
</div>
```

### Responsividade Mobile-First

```tsx
<div className="
  text-sm          // Mobile: 14px
  sm:text-base     // Tablet (640px+): 16px
  lg:text-lg       // Desktop (1024px+): 18px
  
  p-4              // Mobile: padding 16px
  sm:p-6           // Tablet: padding 24px
  lg:p-8           // Desktop: padding 32px
  
  landscape:gap-3  // Landscape mode: gap menor
  landscape:py-4   // Landscape mode: padding vertical menor
">
  Conte√∫do responsivo
</div>
```

**√öltima atualiza√ß√£o:** Novembro 2025  
**Vers√£o:** 1.1.0